# 变量引用减少重复代码
server: &server-ref
  host: 127.0.0.1
  user: root # default root
  port: 22 # default 22
  password: liugx
#  privateKey: xxxxx
#  privateKeyPathAuth: /path/to/file

version: v1.0.0
jobs:
  - name: lenkins-test
    parameters:
      service: satc-access-inner
      environment: gd_inner
    steps:
      - name: Clone
        git:
          repo: git@gitee.com:guoxinliu/lenkins.git
          branch: master
      - name: Compile
        sh:
          - "cd lenkins/main;go build . -o ../bin"
      - name: Send package to Server
        scp:
          type: upload # upload or download
          servers:
            - <<: *server-ref
          remote: "/home/guoxin/Desktop"
          local: "/home/guoxin/Desktop"
      - name: Deploy
        cmd:
          servers:
            - <<: *server-ref
          cmd:
            - "cd /home/guoxin/Desktop; cp lenkins lenkins-bin"
